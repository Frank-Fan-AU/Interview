组件间如何优雅的共享和同步状态



# 什么是状态提升？
将共享状态移至这些组件最近的共同父组件中

# 为什么需要状态提升？

- 兄弟组件共享状态
  
  举个例子，输入框值发生了变化，他旁边的兄弟组件需要同步的显示这个变化的值

- 子组件需要修改父组件或祖先组件的状态

    举个例子：列表项的删除按钮，是个子组件，需要更新父组件的状态


## 有zustand了还会用状态提升吗？

有时会不想把状态放在全局，比如状态是局部的，只在一小块组件树中使用，把这些状态塞进Zustand，反而会造成全局状态污染和复杂度上升

比如：
  - Modal的打开关闭
  - 步骤表单的当前页码
  - 当前选中的Tab页

# 状态提升的优点：

- 明确的数据源： 状态集中管理，易于追踪和理解
- 组件间通信：有效解决了兄弟组件或远房亲戚组件间的状态共享问题
- 数据同步： 确保所有依赖该状态的组件显示一致
- 代码可预测性：更容易推断状态变化如何影响应用

# 状态提升的缺点

- Prop Drilling
  - 状态可能需要通过许多中间层组件传递
  - 中阿金组件被迫接收并传递他们本身不需要的props
- 父组件膨胀：
  - 最近的共同父组件可能承载过多无关状态和逻辑，变得臃肿
- 潜在性能问题:
  - 父组件状态更新可能导致所有子组件重新渲染，需要配合React.memo等优化


# 状态提升的边界

适用场景：
  - 少数几个组件共享状态
  - 组件层级关系相对简单
  - 逻辑清晰，易于维护
何时考虑替代方案？
  - PropDrilling过深：超过2-3层，代码可读性和维护性下降
  - 跨多个模块共享
  - 父组件逻辑过于复杂

# 替代方案

- Context API
  - 注意： Context的更新会导致所有消费该Context的组件重新渲染
- Redux，zustand等状态管理库

# 面试中常见提问：
请解释一下React中的状态提升是什么？以及为什么需要他？

状态提升有哪些优点缺点

什么时候你会选择使用状态提升？什么时候会考虑使用ContextAPI或redux

你如何解决状态提升可能导致的prop drilling问题？
